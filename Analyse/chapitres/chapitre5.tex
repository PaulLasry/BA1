% !TEX root = ../Analyse1.tex
\chapter{Dériviées}
\section{Définitions et exemples}
\begin{definition}[Dériviée]
    Soit $f: D\to\R$ définie au voisinage de $x_0$ ou en $x_0$. Alors $f$ est $\underline{\text{dérivable}}$  ou $\underline{\text{différentiable}}$ en $x_0$ si
    la limite
    \[f'(x_0)=\lim_{h\to 0}\frac{f(x_0+h) -f(x_0)}{h}\]
    existe ($\in \R$).\\
    \textbf{Notation :} \[f'(x_0) = \frac{df}{dx}(x_0) = \partial_xf(x_0) =\mathcal{D}_x f(x_0) = \dot{f}(x_0)\]
    On dit :\begin{itemize}
        \item $f'(x_0)$ est la dérivée de $f$ en $x_0$\\
        \item $f:D\to\R$ est $\underline{\text{dérivable}}$ si elle est dérivable en tout $x_0 \in D$.
    \end{itemize}
\end{definition}
\begin{remark}
    Le nombre $f'(x_0)$ est la pentes de la tengente à la courbe $y=f(x)$ au point$(x_0, f(x_0))$.
\end{remark}
\begin{example}
    \begin{align*}
        f'(x_0)&=\lim_{h\to 0}\frac{f(x_0+h) -f(x_0)}{h}\\
        &=\lim_{x\to x_0} \frac{f(x)-f(x_0)}{x-x_0}
    \end{align*}
\end{example}
\begin{definition}[La fonction dérivée]
    La $\underline{\text{fonction dérivée }}$ d'une fonction $f:D\to\R$ est la fonction \(\begin{aligned}[t]
        f':D(f(x))&\longrightarrow\R\\
        x&\longmapsto f'(x)
    \end{aligned}\) où $D(f') = \left\{x\in D | f\text{ est dérivable en } x\right\}$
\end{definition}
\begin{example}[1]
    $f(x) = x^2$. On a \begin{align*}
        f'(x_0) &=\lim_{h\to 0}\frac{f(x_0+h) -f(x_0)}{h}\\
        &=\lim_{h\to 0}\frac{(x_0+h)^2 -x_0^2}{h}\\
        &= \lim_{h\to 0}(2x_0 +h) = 2\cdot x_0.
    \end{align*}
    Ainsi, $f(x)=x^2$ est dérivable pour tout $x_0\in\R$. Sa dérivée est $f'(x) = 2x$.
\end{example}
\begin{example}[2]
    $f(x)=\sin(x)$, $x_0\in \R$. On a\begin{align*}
        f'(x_0) =& \lim_{h\to 0}\frac{\sin(x_0+h)-\sin(x_0)}{h}\\ 
        =&\lim_{h\to 0}\frac{\sin(x_0)\cos(h)+\cos(x_0)\sin(h)-\sin(x_0)}{h}\\ 
        =& \sin(x_0)\cdot\lim_{h\to 0} \frac{\cos(h)-1}{h} + \cos(x_0)\cdot\lim_{h\to 0}\frac{\sin(h)}{h}\\ 
        \implies& \underbrace{-h}_{\to 0} = \frac{1-h^2-1}{h}\geq\underbrace{\frac{\cos(h)-1}{h}}_{\to 0}\geq \frac{0}{h} = \underbrace{0}_{\to 0}\\
        \implies& \sin(x_0)\cdot 0+\cos(x_0)\cdot1 = \cos(x_0)
    \end{align*}
    $\sin$ est dérivable sur $\R$ et $\sin'(x) = \cos(x)$. De manière analogue : $\cos'(x) = -\sin(x)$²
\end{example}
\begin{proposition}
    Soit $f:D\to\R$
    \begin{enumerate}
        \item Si $f$ est dérivable en $x_0$, alors $f$ est aussi continue en $x_0$
        \item $f$ est dérivable en $x_0$ si et seulement si :\[f(x) = \underbrace{f(x_0)+f'(x_0)\cdot(x-x_0)}_{\text{équation de la tengente}}+ \underbrace{\textcolor{red}{(x-x_0)\cdot\varepsilon(x)}}_{\text{reste}}\]
            où $\varepsilon(x)$ est une fonction tel que $\lim_{x\to x_0} \varepsilon(x)=0$. Le \textcolor{red}{reste} tend plus vite vers $0$ que $x-x_0$
    \end{enumerate}
\end{proposition}
\begin{proof}[Preuve de la proposition]
    \noindent
    \begin{enumerate}
        \item On a \[\lim_{x\to x_0} f(x) = f(x_0) + \lim_{x\to x_0} \frac{f(x)-f(x_0)}{x-x_0} \cdot (x-x_0) = f(x_0)-f'(x_0)\cdot0 = f(x_0)\]
        \item Poser $\varepsilon(x)=\frac{f(x)-f(x_0)-f'(x-0)(x-x_0)}{x-x_0}$ et calculer la limite lorsque $x\to x_0$
    \end{enumerate}
\end{proof}
\begin{remark}
    $f$ continues $\not \implies$ $f$ dérivable.
\end{remark}
\begin{example}
    $f(x) = |x|$, $x_0=0$. Alors $f$ est continue en $0$ mais on a \[\lim_{h\downarrow0}\frac{f(0+h)-f(0)}{h} = \lim_{h\downarrow0}\frac{|h|}{h} = 1\neq -1 = \lim_{h\uparrow0}\frac{|h|}{h} = \lim_{h\uparrow0}\frac{f(0+h)-f(0)}{h}\]
    Donc la limite n'existe pas, donc $f$ n'est pas dérivable en $0$.
\end{example}
\begin{property}[Opérations algébriques]
    Soient $f, g : D\to\R$ derivables en $x_0\in D$. Alors :
    \begin{enumerate}
        \item $\displaystyle(p\cdot f+q\cdot g)'(x_0) = p\cdot f'(x_0)+q\cdot g'(x_0)$
        \item $\displaystyle(f\cdot g)'(x_0) = f'(x_0)\cdot g(x_0) + f(x_0)\cdot g'(x_0)$
        \item $\displaystyle\left(\frac{f}{g}\right)'(x_0) = \frac{f'(x_0)\cdot g(x_0) - f(x_0)\cdot g'(x_0)}{(g(x_0))^2}$, si $g(x_0)\neq 0$
    \end{enumerate}
\end{property}
\begin{property}[Dérivées de fonction usuelles]
    \noindent
    \begin{enumerate}[start=0]
        \item $f(x) = c\in \R \implies f'(x) = 0$
        \item $f(x) = x^n \implies f'(x) = n\cdot x^{n-1}$ pour $\N^*$
        \begin{proof}[Preuve]
            Par récurrence sur $n$.
            \begin{itemize}
                \item $n=1$: $f(x) = x$, $f'(x) = 1$.
                \item Supposons vrai pour $n$, montrons pour $n+1$ :
                    \begin{align*}
                        f(x) &= x^{n+1} = x^n \cdot x\\
                        f'(x) &\overset{\text{Prop 2}}{=} (x^n)' \cdot x + x^n \cdot (x)'\\
                        &= n\cdot x^{n-1} \cdot x + x^n \cdot 1 = (n+1)\cdot x^n
                    \end{align*}
            \end{itemize}   
        \end{proof}
        \item $\sin'(x) = \cos(x), \cos'(x) = -\sin(x)$ et \[\tan'(x) = \left(\frac{\sin(x)}{\cos(x)}\right)' \overset{\text{Prop 3}}{=} \frac{\sin'(x)\cos - \sin(x)\cos'(x)}{\cos^2(x)} = \cdots = \frac{1}{\cos^2(x)} \text{ ou } 1 + \tan^2(x)\]
        \item $f(x)=x^{-n}$, $n\in \N^*, x\neq0$\[\implies f(x)=\frac{1}{x^n} \overset{\text{Prop 3}}{\implies} f'(x) = -n\cdot x^{-n-1}\]
    \end{enumerate}
\end{property}
\begin{property}[Dériviées de composées]
    Soient $f : A\to B$, $g: B \to \R$, deux fonction telles que $f$ est dérivable en $x_0$ et $g$ est dérivable en $f(x_0)$. Alors:
    \begin{align*}
        \left(g(f(x_0))\right)' &= (g\circ f)'(x_0) \\
        &= g'(f(x_0))\cdot \underbrace{f'(x_0)}_{\text{Dériviée interne}}
    \end{align*}
    \begin{proof}[Preuve]
        Le quotient est \begin{align*}
            &\frac{g(f(x_0+h)) - g(f(x_0))}{h} \\
            =& \frac{g(f(x_0+h)) - g(f(x_0))}{f(x_0+h) - f(x_0)} \cdot \frac{f(x_0+h) - f(x_0)}{h}
        \end{align*}
        En prenant la limite lorsque $h\to 0$, on obtient le résultat voulu.
    \end{proof}
\end{property}
\begin{property}[Dériviées des réciproques]
    Soit $f: A\to B$ bijective et dérivable sur $A$, un intervalle ouvert. Si $f'(x)\neq 0$ pour tout $x\in A$, alors
    \[\left(f^{-1}\right)'(x) = \frac{1}{f'(f^{-1(x)})}\]
    \begin{proof}[Preuve]
        On admet que $f^{-1}$ est dérivable sur tout $B$. On dérive l'equation $f(f^{-1}(x)) = x$ des deux cotés :
        \begin{align*}
            1 &= (f\circ f^{-1})'(x) = f'\left(f^{-1}(x)\right)\\ 
            \implies& \frac{1}{f'\left(f^{-1}(x)\right)} = (f^{-1})'(x)
        \end{align*}
    \end{proof}
\end{property}
\begin{example}[1]
    $f(x) = \sqrt[n]{x} = f^{-1}(x)$ où $f(x)=x^n$, où $x>0$
    \begin{align*}
        x &= f(g(x)) = \left(\sqrt[n]{x}\right)^n\\
        &\implies 1 = n(\sqrt[n]{x})^{n-1}\cdot (\sqrt[n]{x})'\\
        &\implies (\sqrt[n]{x})' = \frac{1}{n(\sqrt[n]{x})^{n-1}} = \frac{1}{n}x^{\frac1n -1}
    \end{align*} 
    On montre de manière analogue que $\left(x^{\frac{p}{q}}\right) = \frac{p}{q}x^{\frac{p}{q}-1}$ pour tout $\frac{p}{q} \in \Q$ et on verra que c'est aussi vrai pour tout réel.
\end{example}
\begin{example}[2]
    $\arcsin'(x) = \frac{1}{\cos(\arcsin(x))}, x\in ]-1,1[$
        \begin{center}
            \includegraphics[width=0.8\textwidth]{derivee_arcsin.png}
        \end{center}        
    \[\implies arcsin'(x) = \frac{1}{\sqrt{1-x^2}}\]
\end{example}
\begin{definition}
    $\lim_{h \downarrow 0}\frac{f(x+h)-f(h)}{h}$ est la dérivée à droite, si $h\uparrow 0$, c'est la dérivée à gauche.
\end{definition}
\begin{property}
    $f$ est dérivable en $x_0$ si et seulement si les deux dérivées latérales existent et sont égales.
\end{property}
\begin{example}[1]
    $f(x) = \left|x\right|$. On a:
    \begin{align*}
        f'_{\text{doite}} (0) = 1 \neq -1 = f'_{\text{gauche}}(0)
    \end{align*} 
    Donc $f$ n'est pas dérivable en $0$.
\end{example}
\begin{example}[2]
    $f(x) = \sqrt[3]{x}$. On a:
    \[\lim_{h\to 0}\frac{f(0+h)-f(0)}{h} = \lim_{x\to 0}\frac{\sqrt[3]{h}}{h} = \lim_{h \to 0}\frac{1}{\left(\sqrt[3]{n}\right)^2} = \frac{1}{0^+} = +\infty\]
    $f'(0)$ n'existe pas, mais les deux dérivées latérales sont égales à $+\infty$.
\end{example}
\begin{definition}[Dériviée d'ordre supérieur]
    La \underline{dérivée seconde} de $f$ est \[f''(x)=f^{(2)}(x)=\left(f'(x)\right)'\]
    La \underline{dérivée d'ordre n} de $f$ est définie par récurrence : \[f^{(n)}(x) = \left(f^{(n-1)}(x)\right)'\]
\end{definition}
\begin{definition}[Clsses de fonctions dérivables]
    Soit $I$ un intervalle. Alors
    \begin{align*}
        &D^n(I) = \left\{f : I\to \R | \,f \text{ est $n$ fois dérivable sur } I\right\}\\
        &C^n(I) = \left\{f : I\to \R | \,f \text{ est $n$ fois dérivable sur et $f^{(n)}$ est continue sur } I\right\}
    \end{align*}
    On pose $C^{\infty}(I) = \left\{f : I\to\R\, |\, f^{(n)}\text{ existe pour tour } n\in \N\right\}$.
\end{definition}
\begin{remark}
    \noindent
    \begin{itemize}
        \item $C^0(I)$ est l'ensemble des fonctions continues sur $I$.
        \item Les fonction polynomiales, trigonométriques, exponentielles, logarithmes, rationnelles sont dans $C^{\infty}$ sur leur domaine de définition.
        \item $C^0(I) \supseteq D^1(I)\supseteq C^1(I) \supseteq D^2(I) \supseteq C^2(I) \supseteq \cdots D^{\infty} \supseteq C^{\infty}$
    \end{itemize}
\end{remark}
\begin{center}
    \includegraphics[width=0.8\textwidth]{classes_derivee.png}

\end{center}
\begin{remark}
    \noindent
    \begin{itemize}
        \item $x^n|x|$ est dans $C^{n}(\R)\setminus D^{n+1}(\R)$
        \item $x|x| \begin{aligned}[t]
            &\in C^{\infty}(]0, +\infty[)\\
            &\in C^{\infty}(]-\infty, 0[)
        \end{aligned}$
    \end{itemize}
\end{remark}
\begin{example}[$D^1\setminus C^1$]
    On a $f(x)=\begin{cases}
        x^2\cos\left(\frac{1}{x}\right) & x\neq 0\\
        0 & x=0
    \end{cases}$. Alors \[f'(x) = 2x\cos\left(\frac1x\right)+\sin\left(\frac{1}{x}\right) \; \text{si x $\neq 0$}\]
    et \[f'(0) = \lim_{h\to 0}\frac{f(h)-f(0)}{h} = \lim_{h\to 0} h\cos\left(\frac1h\right) = 0\]
    donc $f(x)$ appartient à $D^1(\R)$. Cependant, \[\lim_{x\to 0} f'(x) \text{ n'existe pas}\] donc $f'(x)$ n'est pas continue en $0$. Donc $f(x)\not\in C^1(\R)$.
\end{example}

\section{Dérivée et croissance}
\begin{theorem}[Théorhème de Rolle]
    Soit $f:[a,b]\to\R$ continue sur $[a,b]$ et dérivable sur $]a,b[$. On suppose que $f(a)=0=f(b)$. Alors $\exists u\in ]a, b[$ tel que $f'(u)=0$.
        \centering
        \includegraphics[width=0.5\textwidth]{rolle.png}    
\end{theorem}
\begin{proof}[Preuve par le TVI]
    Par le TVI, $f$ atteint son max $M=\max_{x\in[a,b]} f(x)$, on le suppose supérieur à $0$. Alors $\exists u\in ]a, b[$ tel que :
    \begin{align*}
        f(u)=M \implies f'(u)=f'_{\text{droite}}(u)&=\lim_{x\to u^+}\frac{f(x)-f(u)}{x-u}\leq 0\\ 
        \text{et}\quad f'(u) = f'_{\text{gauche}}(u) &= \lim_{x\to u^-}\frac{f(x)-f(u)}{x-u} \geq 0\\
    \end{align*}
    Donc $f'(u)=0$.
\end{proof}
\begin{theorem}[Théorhème des acroissements finis (TAF)]
    Soit $f:[a, b]\to \R$ continue, dérivable sur $]a, b[$. Alors $\exists u\in ]a, b[$ tel que :
    \begin{align*}
        f'(u)=\frac{f(b)-f(a)}{b-a}
    \end{align*}
    \centering
    \includegraphics[width=0.5\textwidth]{TAF.png}
\end{theorem}
\begin{proof}[Preuve]
    En exercice.
\end{proof}
\begin{property}[Application du TAF]
    Soit $f:[a,b]\to\R$ continue sur $[a,b]$ et dérivable sur $]a,b[$.
    \begin{enumerate}
        \item Si $f'(x)=0$ pour tout $x\in ]a,b[$, alors $f$ est constante sur $[a,b]$.
        \begin{proof}[Preuve]
            Le sens "$\impliedby$" est évident. Pour le sens "$\implies$", si $f$ n'est pas constante, on trouve $c, d \in [a, b]$ tels que $c<d$ et  $f(c) \neq f(d)$. 
            Par le TAF, $\exists u\in ]c,d[$ tel que \[f'(u) = \frac{f(d)-f(c)}{d-c} \neq 0\] ce qui est une contradiction.
        \end{proof}
        \item Si $g:[a, b]\overset{\text{continue}}{\longrightarrow }\R$ dérivable sur $]a,b[$ et $f'(x)=g'(x)$ pour tout $x\in ]a,b[$, alors $f(x) = g(x) + c$ pour un certain $c\in \R$ et tout $x\in [a,b]$.
        \item Si $f'(x)\geq 0$ pour tout $x\in ]a,b[$, alors $f$ est croissante sur $[a,b]$.
        \item Si $f'(x)\leq 0$ pour tout $x\in ]a,b[$, alors $f$ est décroissante sur $[a,b]$.
        \item Si $f'(x)>0$ pour tout $x\in ]a,b[$, alors $f$ est strictement croissante sur $[a,b]$.
        \item Si $f'(x)<0$ pour tout $x\in ]a,b[$, alors $f$ est strictement décroissante sur $[a,b]$.
    \end{enumerate}
\end{property}
\begin{remark}
    Attention au point 5 et 6, la réciproques est en général fausse. Par exemple, $f(x) = x^3$ est strictement croissante sur $\R$ mais $f'(0)=0$.
\end{remark}
\subsection{La fonction exponentielle (et logarithmes)}
\begin{theorem}
    Il existe une \underline{unique} fonction $f:\R\to\R$ telle que :
    \begin{align*}
        f'(x) = f(x) \; \forall x\in\R \quad \text{ et } \quad f(0) = 1 
    \end{align*}
\end{theorem}
\begin{proof}[Preuve]
    La preuve de l'existence se fera plus tard.\\ 
    Pour l'unicité, la preuve se fait en deux étapes :
    \begin{enumerate}
        \item $f(x)\neq0 \;\forall x\in \R$. On pose $h(x)=f(x)\cdot f(-x)$. On calcule la dérivée de $h$:
            \begin{align*}
                h'(x) &= f'(x)\cdot f(-x)+ f(x)\cdot \underbrace{f'(-x)}_{=f(-x)}(-1)\\
                &= 0
            \end{align*}
            Donc $h$ est constante ! Comme $h(0) = f(0)\cdot f(0) = 1$, on a \[h(x) = \underbrace{f(x)}_{\neq 0}\cdot f(-x) = 1\]
        \item \textbf{Unicité : } Soit $g(x)$ une (autre) fonction telle que $g'(x)=g(x)$ et $g(0)=1$. On pose $h(x) = \frac{g(x)}{f(x)}$. On calcule $h'(x)$ :
            \begin{align*}
                h'(x) = \frac{g'\cdot f - g\cdot f'}{f^2} = \frac{g\cdot f - g\cdot f}{f^2} = 0
            \end{align*}
            Donc $h$ est constante. Comme $h(0) = \frac11 = 1$ on a que $h(x)=1=\frac{g(x)}{f(x)} = 1 \implies g(x) = f(x)$ 
    \end{enumerate} 
\end{proof}

\begin{definition}[Foonction exponentielle]
    Cette fonction s'appelle la fonction \\ \underline{exponentielle}. Notée \[\exp(x) \quad \text{ (plus tard } e^x)\]
\end{definition}
\begin{property}[$\exp(x)$]
    \noindent
    \begin{enumerate}
        \item $\exp'(x) = \exp(x)$ et $\exp(0)=1$ nous donne \[\exp \in C^\infty(\R)\]
        \item $\exp(x)\neq 0 \; \forall x\in \R$ et $\exp(-x) = \displaystyle\frac{1}{\exp(x)}$
        \item $\exp$ est strictement croissante
        \item $\exp(x+y) = \exp(x)\cdot\exp(y) \; \forall x\in\R$
        \item $\lim_{x\to +\infty} \exp(x)=+\infty$, $\lim_{x\to 0} \exp(x)=0$
            \begin{proof}[Preuve]
                $\exp(x) \geq x$. En effet, si $g(x) = \exp(x)-x$, on a 
                \begin{align*}
                    g'(x) =& \exp(x)-1 > 0 (x > 0)\\
                    \implies& g \text{ est strictement croissante sur } [0, +\infty[
                \end{align*}  
                Comme $g(0)=1$, donc $g(x)\geq 0$
            \end{proof}
        \item $\exp(1) =\displaystyle \lim_{n\to \infty}\left(1+\frac{1}{n}\right)^n$
    \end{enumerate}
    Ainsi : $\exp(2) = \exp(1+1) = \exp(1)\cdot\exp(1) = e^2$ et 
    \[\exp(n) = e^n \quad \forall x\in\R\]
    De plus $\exp(-n) = \frac{1}{\exp(n)} = \frac{1}{e^n} = e^{-n}$ et on vérifie que $\left(1+\frac{1}{n}\right)^n = e$. Donc :
    \[\exp\left(\frac{p}{q} = e^{\frac{p}{q}}\right) \quad \forall \textstyle\frac{p}{q}\in\Q\]
\end{property}
\begin{definition}
    Pour $x\in\R$, on pose que \[e^x = \exp(x)\]
\end{definition}
\begin{remark}
    La fonction exponentielle est 
    \begin{itemize}
        \item injective (car strictement croissante)
        \item surjective (coréstraintes à $]0, +\infty[$)
    \end{itemize}
    Donc $\exp(x)$ est bijective !
\end{remark}
\begin{definition}[Logarithme]
    Le \underline{logarithme} est la réciproque que la fonction exponentielle. Donc :
    \begin{align*}
        \log : \; ]0, + \infty[ &\longrightarrow \R\\
        x &\longmapsto \log(x) = \ln(x)
    \end{align*}
\end{definition}
\begin{property}[Logarithme]
    \noindent
    \begin{enumerate}
        \item $\mathcal{D}(\ln) = \;]0, + \infty[$ et $\Im(\ln) = \R$. 
        \item $\ln(1) = 0$. On a :
            \begin{align*}
                &x = \exp(\ln(x)) \\
                \iff& 1 = \exp'(\ln(x))\cdot\ln'(x) = x\ln'(x)\\
                \implies& \ln'(x) = \frac{1}{x}\\
                \implies& \ln \in C^\infty\left(]0, +\infty[\right)
            \end{align*} 
        
        \item $\log$ est strictement croissante.
        \item $\lim_{x\to+\infty}\log(x)=+\infty$ et $\lim_{x\to 0^+}\log(x)=-\infty$.
    \end{enumerate}
\end{property}
\begin{definition}[Autres bases]
    Pour $a\in\R > 0$\begin{align*}
        \exp_a(x) &\overset{\text{def}}{=} \exp(\log(a)\cdot x) = a^x\\ 
        \log_a(x) &= \text{ réciproque }\\ 
        &= \frac{\ln(x)}{\ln(a)}
    \end{align*}
\end{definition}
\begin{remark}
    Pour $x, u\in\R$ et $x>0$, on a :
    \begin{align*}
        &x^u = \exp(\log(x)\cdot u)\\
        \implies& (x^u)'=\cdots = ux^{u-1}
    \end{align*} 
\end{remark}